(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory():typeof define==="function"&&define.amd?define(factory):(global=global||self,global.browserStore=factory())})(this,(function(){"use strict";var parse_1=parse;var serialize_1=serialize;var decode=decodeURIComponent;var encode=encodeURIComponent;var pairSplitRegExp=/; */;var fieldContentRegExp=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function parse(str,options){if(typeof str!=="string"){throw new TypeError("argument str must be a string")}var obj={};var opt=options||{};var pairs=str.split(pairSplitRegExp);var dec=opt.decode||decode;for(var i=0;i<pairs.length;i++){var pair=pairs[i];var eq_idx=pair.indexOf("=");if(eq_idx<0){continue}var key=pair.substr(0,eq_idx).trim();var val=pair.substr(++eq_idx,pair.length).trim();if('"'==val[0]){val=val.slice(1,-1)}if(undefined==obj[key]){obj[key]=tryDecode(val,dec)}}return obj}function serialize(name,val,options){var opt=options||{};var enc=opt.encode||encode;if(typeof enc!=="function"){throw new TypeError("option encode is invalid")}if(!fieldContentRegExp.test(name)){throw new TypeError("argument name is invalid")}var value=enc(val);if(value&&!fieldContentRegExp.test(value)){throw new TypeError("argument val is invalid")}var str=name+"="+value;if(null!=opt.maxAge){var maxAge=opt.maxAge-0;if(isNaN(maxAge))throw new Error("maxAge should be a Number");str+="; Max-Age="+Math.floor(maxAge)}if(opt.domain){if(!fieldContentRegExp.test(opt.domain)){throw new TypeError("option domain is invalid")}str+="; Domain="+opt.domain}if(opt.path){if(!fieldContentRegExp.test(opt.path)){throw new TypeError("option path is invalid")}str+="; Path="+opt.path}if(opt.expires){if(typeof opt.expires.toUTCString!=="function"){throw new TypeError("option expires is invalid")}str+="; Expires="+opt.expires.toUTCString()}if(opt.httpOnly){str+="; HttpOnly"}if(opt.secure){str+="; Secure"}if(opt.sameSite){var sameSite=typeof opt.sameSite==="string"?opt.sameSite.toLowerCase():opt.sameSite;switch(sameSite){case true:str+="; SameSite=Strict";break;case"lax":str+="; SameSite=Lax";break;case"strict":str+="; SameSite=Strict";break;case"none":str+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return str}function tryDecode(str,decode){try{return decode(str)}catch(e){return str}}var cookie={parse:parse_1,serialize:serialize_1};var preKey="";var testKey="__test__";var cookieOptions={path:"/"};var getItem=function getItem(key){var cookieObj=cookie.parse(document.cookie);return cookieObj[preKey+key]===undefined?null:cookieObj[preKey+key]};var setItem=function setItem(key,value){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};options=Object.assign({},cookieOptions,options);document.cookie=cookie.serialize(preKey+key,value,options)};var removeItem=function removeItem(key,options){options=Object.assign({},cookieOptions,options,{maxAge:-1});document.cookie=cookie.serialize(preKey+key,"",options)};var isSupport=function isSupport(){try{setItem(testKey,"a");var value1=getItem(testKey);removeItem(testKey);var value2=getItem(testKey);return value1==="a"&&value2===null}catch(e){return false}};var setOptions=function setOptions(option){cookieOptions=Object.assign({},cookieOptions,option)};var setPreKey=function setPreKey(key){preKey=key};var setTestKey=function setTestKey(key){testKey=key};var cookieStore={getItem:getItem,setItem:setItem,removeItem:removeItem,isSupport:isSupport,setOptions:setOptions,setPreKey:setPreKey,setTestKey:setTestKey};var preKey$1="";var testKey$1="__test__";var getItem$1=function getItem(key){return localStorage.getItem(preKey$1+key)};var setItem$1=function setItem(key,value){localStorage.setItem(preKey$1+key,value)};var removeItem$1=function removeItem(key){localStorage.removeItem(preKey$1+key)};var isSupport$1=function isSupport(){try{setItem$1(testKey$1,"a");var value1=getItem$1(testKey$1);removeItem$1(testKey$1);var value2=getItem$1(testKey$1);return value1==="a"&&value2===null}catch(e){return false}};var setPreKey$1=function setPreKey(key){preKey$1=key};var setTestKey$1=function setTestKey(key){testKey$1=key};var localStore={getItem:getItem$1,setItem:setItem$1,removeItem:removeItem$1,isSupport:isSupport$1,setPreKey:setPreKey$1,setTestKey:setTestKey$1};var preKey$2="";var testKey$2="__test__";var getItem$2=function getItem(key){return sessionStorage.getItem(preKey$2+key)};var setItem$2=function setItem(key,value){sessionStorage.setItem(preKey$2+key,value)};var removeItem$2=function removeItem(key){sessionStorage.removeItem(preKey$2+key)};var clear=function clear(){sessionStorage.clear()};var isSupport$2=function isSupport(){try{setItem$2(testKey$2,"a");var value1=getItem$2(testKey$2);removeItem$2(testKey$2);var value2=getItem$2(testKey$2);return value1==="a"&&value2===null}catch(e){return false}};var setPreKey$2=function setPreKey(key){preKey$2=key};var setTestKey$2=function setTestKey(key){testKey$2=key};var seesionStore={getItem:getItem$2,setItem:setItem$2,removeItem:removeItem$2,clear:clear,isSupport:isSupport$2,setPreKey:setPreKey$2,setTestKey:setTestKey$2};var cookieStoreIsSupport=cookieStore.isSupport();var localStoreIsSupport=localStore.isSupport();var seesionStoreIsSupport=seesionStore.isSupport();var priority="lc";var getItem$3=function getItem(key){var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=priority[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var type=_step.value;if(type==="l"&&localStoreIsSupport){return localStore.getItem(key)}if(type==="c"&&cookieStoreIsSupport){return cookieStore.getItem(key)}if(type==="s"&&seesionStoreIsSupport){return seesionStore.getItem(key)}}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}return null};var setItem$3=function setItem(key,value){var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=priority[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var type=_step2.value;if(type==="l"&&localStoreIsSupport){localStore.setItem(key,value);return true}if(type==="c"&&cookieStoreIsSupport){cookieStore.setItem(key,value);return true}if(type==="s"&&seesionStoreIsSupport){seesionStore.setItem(key,value);return true}}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return!=null){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}return false};var removeItem$3=function removeItem(key){var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=priority[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var type=_step3.value;if(type==="l"&&localStoreIsSupport){localStore.removeItem(key);return true}if(type==="c"&&cookieStoreIsSupport){cookieStore.removeItem(key);return true}if(type==="s"&&seesionStoreIsSupport){seesionStore.removeItem(key);return true}}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally{try{if(!_iteratorNormalCompletion3&&_iterator3.return!=null){_iterator3.return()}}finally{if(_didIteratorError3){throw _iteratorError3}}}return false};var setPriority=function setPriority(key){priority=key};var setPreKey$3=function setPreKey(key){cookieStore.setPreKey(key);localStore.setPreKey(key);seesionStore.setPreKey(key)};var index={getItem:getItem$3,setItem:setItem$3,removeItem:removeItem$3,setPriority:setPriority,setPreKey:setPreKey$3,cookieStoreSetPreKey:cookieStore.setPreKey,localStoreSetPreKey:localStore.setPreKey,seesionStoreSetPreKey:seesionStore.setPreKey,cookieStoreIsSupport:cookieStoreIsSupport,localStoreIsSupport:localStoreIsSupport,seesionStoreIsSupport:seesionStoreIsSupport,cookieSetOptions:cookieStore.setOptions};return index}));